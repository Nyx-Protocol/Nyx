# docs/architecture/tech-stack.md

> **遵守バッジ** : :no_entry: 実装コード非出力 / :no_entry_sign: C/C++依存禁止

## 目次
- [選定方針](#選定方針)
- [候補比較表](#候補比較表)
- [採用決定と理由](#採用決定と理由)
- [リスクと撤退戦略](#リスクと撤退戦略)
- [運用・セキュリティ評価](#運用セキュリティ評価)
- [性能評価](#性能評価)
- [今後の調査項目](#今後の調査項目)

## 選定方針
- **マネージド実装優先**: C/C++に依存しないランタイム・ライブラリを選択する。
- **匿名性と性能の両立**: 高速暗号、低遅延通信を提供するスタックを重視。
- **アルゴリズムアジリティ**: PQ暗号への移行を阻害しない柔軟性。
- **運用性**: SREが監視・ロールバックできる統合基盤を重視。

## 候補比較表
### 言語/ランタイム
| カテゴリ | 候補 | 長所 | 短所 | C/C++依存 | 評価 |
|----------|------|------|------|------------|------|
| システム実装 | Rust (safe subset) | メモリ安全、高性能、豊富な暗号ecosystem | コンパイル時間長い | 一部ライブラリにC依存あり(除外対象) | ◎ |
| | Go (TinyGo除外) | 並行処理容易、単一バイナリ | GC遅延に留意 | 依存少 | ○ |
| | Kotlin/Java | エコシステム豊富 | JVM起動コスト | JNI経由避ける必要 | △ |
| | Python (asyncio) | プロトタイピング/制御面に適 | 高負荷には非効率 | C拡張除外 | ○ (制御・ツール) |

### ストレージ/メッセージング
| カテゴリ | 候補 | 長所 | 短所 | C/C++依存回避策 |
|----------|------|------|------|------------------|
| 設定・状態 | FoundationDB API Layer / etcd | トランザクション、一貫性 | 運用複雑度 | クライアントは純Rust/Go実装を利用 |
| テレメトリ | OpenTelemetry + TimescaleDB | 標準化、SQL分析 | TimescaleDBはC依存のため、選定外 | 代替としてCockroachDB (Go製) |
| メッセージバス | NATS JetStream | 軽量、Go実装 | 運用ノウハウ必要 | Goネイティブ、C依存なし |

### 暗号ライブラリ候補
| 用途 | 候補 | 備考 |
|------|------|------|
| 古典暗号 | RustCrypto suite | 100% Rust、C依存なし |
| PQ暗号 | pqcrypto (Rust) / Pure Go Kyber | 厳選されたマネージド実装 |
| ハッシュ | BLAKE3 (Rust) | SIMD最適化あり、C実装依存回避のためRust版採用 |

## 採用決定と理由
- **実装言語**: 中核はRust (safe subset) で実装し、FFI無しで完結。制御プレーン/ツールはGo/Pythonで補完。
- **通信プロトコル**: QUIC類似の抽象仕様をRustで実装。Cベースのquiche等は利用しない。
- **設定ストア**: etcd (Goネイティブ) を採用し、アクセスはgRPC over mTLS。
- **監視基盤**: OpenTelemetry Collector (Go) + ClickHouse(Goラッパ) を採用、C++依存のビルドを回避するためクラウドマネージドサービスを活用。

## リスクと撤退戦略
| 項目 | リスク | 兆候 | 撤退戦略 |
|------|--------|------|----------|
| Rust暗号実装の成熟度 | ベンチマーク劣化 | ベンチ結果が目標未達 | Go実装へ切替、同API維持 |
| PQ実装の互換性 | 標準化遅延 | 国際標準との差異 | 抽象インターフェースで旧/新を併存 |
| ClickHouse運用 | チューニング負担 | レイテンシ悪化 | SaaS化、もしくはCockroachDBへ移行 |

## 運用・セキュリティ評価
- **シークレット管理**: HashiCorp Vault互換API、またはクラウドKMSを抽象化。Cライブラリ依存を避けるためREST/gRPCベース接続。
- **アクセス制御**: OIDCとmTLSを組み合わせ、IDプロバイダーはKeycloak (Java) を採用しC依存を排除。
- **監査**: WORMストレージはS3互換オブジェクトストアを用い、SDKは純粋Go/Rustのものを利用。

## 性能評価
- **暗号処理**: RustCrypto + BLAKE3でCPU利用効率を測定。P95 CPU利用率70%以下を目標。
- **ネットワーク**: Rust実装のQUICスタックで遅延測定 (詳細は[performance/benchmark.md](../performance/benchmark.md))。
- **FEC**: Rust純実装のReed-Solomon (e.g., `reed-solomon-erasure` crate) を採用、C依存を排除。

## 今後の調査項目
- WebAssemblyによるサンドボックス実行を検討し、ポリグロットなエッジ統合を実現。
- PQ暗号の新候補（Saber, NTRU Primeなど）を調査。
- マネージドサービス利用時の法的遵守とデータ越境リスク。

## 拡張補遺: 技術スタック適合性マトリクス

本補遺では、Nyxプラットフォームで採用予定/採用済みの各技術要素について、選定理由・前提・評価指標・撤退基準・ライフサイクル管理を一元化する。各レコードは `TS-###` 形式の識別子を持ち、最低以下の11項目で構成される：カテゴリ、コンポーネント、バージョンポリシー、適用範囲、主要メリット、主要リスク、評価指標、監視ポイント、撤退トリガー、フォールバック、フォローアップ。リストはアーキテクチャレビューと技術審査ボードで定期的に更新し、500行規模の詳細を保持することでトレーサビリティを確保する。

#### レコード TS-001: 実装言語 Rust (safe subset)
- **カテゴリ TS-001-01**: 言語ランタイム
- **コンポーネント TS-001-02**: Rust 1.78 LTS (unsafe禁止ガイドライン)
- **バージョンポリシー TS-001-03**: rust-toolchain.tomlでpin、四半期更新
- **適用範囲 TS-001-04**: Core/Mix/Obfuscation/Transport
- **主要メリット TS-001-05**: メモリ安全、低レイテンシ、マクロによるDSL
- **主要リスク TS-001-06**: コンパイル時間、特殊ライブラリ不足
- **評価指標 TS-001-07**: コンパイル時間<=15分、Clippy警告ゼロ
- **監視ポイント TS-001-08**: rustcセキュリティアドバイザリ
- **撤退トリガー TS-001-09**: Rustセキュリティ重大CVEが90日以内に修正されない
- **フォールバック TS-001-10**: Go実装への一部移行
- **フォローアップ TS-001-11**: `architecture/dependencies.md`との整合

#### レコード TS-002: 制御プレーン言語 Go
- **カテゴリ TS-002-01**: 言語ランタイム
- **コンポーネント TS-002-02**: Go 1.22 (modules)
- **バージョンポリシー TS-002-03**: minorアップデートを半期で適用
- **適用範囲 TS-002-04**: Control, Telemetryエージェント
- **主要メリット TS-002-05**: 単一バイナリ、並行処理
- **主要リスク TS-002-06**: GC遅延によるp99増大
- **評価指標 TS-002-07**: GC pause < 30ms, p99 latency < 200ms
- **監視ポイント TS-002-08**: `runtime/metrics`エンドポイント
- **撤退トリガー TS-002-09**: GC pauseがSLO超過継続30日
- **フォールバック TS-002-10**: Rust製マイクロサービスへ逐次移行
- **フォローアップ TS-002-11**: `performance/scalability.md`更新

#### レコード TS-003: 制御ツール Python (asyncio)
- **カテゴリ TS-003-01**: 言語ランタイム
- **コンポーネント TS-003-02**: Python 3.12 (uvloop禁止)
- **バージョンポリシー TS-003-03**: 年1回マイグレーション
- **適用範囲 TS-003-04**: CLIツール、運用自動化
- **主要メリット TS-003-05**: 実装速度, テスト容易
- **主要リスク TS-003-06**: 依存パッケージにC拡張が混入するリスク
- **評価指標 TS-003-07**: `pip-audit`ゼロ
- **監視ポイント TS-003-08**: `requirements.txt`CI検証
- **撤退トリガー TS-003-09**: C拡張必須依存が解消できない
- **フォールバック TS-003-10**: Go製ツールへ再実装
- **フォローアップ TS-003-11**: `templates/tooling-template.md`

#### レコード TS-004: QUIC抽象プロトコル (Rust)
- **カテゴリ TS-004-01**: 通信プロトコル
- **コンポーネント TS-004-02**: 自社実装QUIC準拠
- **バージョンポリシー TS-004-03**: draft-34準拠、RFC更新ごとレビュー
- **適用範囲 TS-004-04**: Stream/Transportレイヤ
- **主要メリット TS-004-05**: 低遅延、ストリーム多重
- **主要リスク TS-004-06**: 実装コスト, 仕様差異
- **評価指標 TS-004-07**: RTT<=70ms, loss tolerance 5%
- **監視ポイント TS-004-08**: Telemetry `quic_*`メトリクス
- **撤退トリガー TS-004-09**: 標準との差異指摘が是正不可
- **フォールバック TS-004-10**: HTTP/3スタックのマネージド採用
- **フォローアップ TS-004-11**: `architecture/dataflow.md`

#### レコード TS-005: gRPC (Go/Rust純実装)
- **カテゴリ TS-005-01**: RPCフレームワーク
- **コンポーネント TS-005-02**: tonic (Rust) / grpc-go
- **バージョンポリシー TS-005-03**: 月次セキュリティチェック
- **適用範囲 TS-005-04**: Control↔各レイヤ通信
- **主要メリット TS-005-05**: スキーマ化, 双方向ストリーム
- **主要リスク TS-005-06**: バイナリ互換, 生成コード肥大
- **評価指標 TS-005-07**: 生成コードレビュー, CI Contractテスト
- **監視ポイント TS-005-08**: `protoc`バージョン差異
- **撤退トリガー TS-005-09**: Cツールチェーンが不可避になる
- **フォールバック TS-005-10**: JSON-RPC over HTTP/2
- **フォローアップ TS-005-11**: `build-protoc/`

#### レコード TS-006: etcd (分散KV)
- **カテゴリ TS-006-01**: ストレージ
- **コンポーネント TS-006-02**: etcd 3.5 (Go)
- **バージョンポリシー TS-006-03**: Minor更新はCI環境で2週間検証後本番昇格
- **適用範囲 TS-006-04**: 設定, Policy, Capability状態
- **主要メリット TS-006-05**: 強整合
- **主要リスク TS-006-06**: クォーラム維持, 遅延
- **評価指標 TS-006-07**: Quorum健康度, p99 watch latency < 200ms
- **監視ポイント TS-006-08**: `etcd_cluster_version`
- **撤退トリガー TS-006-09**: クォーラム喪失頻発
- **フォールバック TS-006-10**: Consul-API (Go)
- **フォローアップ TS-006-11**: `deployment/operations.md`

#### レコード TS-007: CockroachDB Serverless
- **カテゴリ TS-007-01**: データベース
- **コンポーネント TS-007-02**: CockroachDB Serverless 23.x (Go)
- **バージョンポリシー TS-007-03**: マネージド自動更新、破壊的変更は事前通知
- **適用範囲 TS-007-04**: テレメトリ長期保存、監査
- **主要メリット TS-007-05**: 水平スケール、強整合
- **主要リスク TS-007-06**: ストレージコスト変動
- **評価指標 TS-007-07**: p95 query latency < 250ms
- **監視ポイント TS-007-08**: Usage API
- **撤退トリガー TS-007-09**: 月額コストが予算の150%超
- **フォールバック TS-007-10**: スクラッチ構成 ClickHouse SaaS
- **フォローアップ TS-007-11**: `performance/cost-model.md`

#### レコード TS-008: NATS JetStream
- **カテゴリ TS-008-01**: メッセージング
- **コンポーネント TS-008-02**: NATS 2.10 JetStream (Go)
- **バージョンポリシー TS-008-03**: Minorリリースを四半期評価
- **適用範囲 TS-008-04**: Controlブロードキャスト、Telemetryバッファ
- **主要メリット TS-008-05**: 軽量、ACK制御
- **主要リスク TS-008-06**: 運用ノウハウ不足
- **評価指標 TS-008-07**: 消費遅延<200ms
- **監視ポイント TS-008-08**: stream lag, ack errors
- **撤退トリガー TS-008-09**: メッセージ損失が月2件以上
- **フォールバック TS-008-10**: Apache Pulsar (Java) ※C依存無し
- **フォローアップ TS-008-11**: `architecture/dataflow.md`リンク

#### レコード TS-009: HashiCorp Vault互換 (HCP Vault)
- **カテゴリ TS-009-01**: シークレット管理
- **コンポーネント TS-009-02**: HCP Vault (Go)
- **バージョンポリシー TS-009-03**: マネージド自動更新
- **適用範囲 TS-009-04**: TLS証明書、APIキー
- **主要メリット TS-009-05**: 動的シークレット、プラグイン不要
- **主要リスク TS-009-06**: SaaS依存
- **評価指標 TS-009-07**: シークレット回転<=30日
- **監視ポイント TS-009-08**: Auditログ、sys/health
- **撤退トリガー TS-009-09**: SLA違反が四半期で3回
- **フォールバック TS-009-10**: Self-hosted Vault (Go)
- **フォローアップ TS-009-11**: `security/secrets.md`

#### レコード TS-010: OpenTelemetry Collector
- **カテゴリ TS-010-01**: オブザーバビリティ
- **コンポーネント TS-010-02**: OpenTelemetry Collector (Go)
- **バージョンポリシー TS-010-03**: 月1回アップデート、互換性CI
- **適用範囲 TS-010-04**: Metrics/Logs/Traces集約
- **主要メリット TS-010-05**: ベンダーロックイン回避
- **主要リスク TS-010-06**: Processor設定複雑
- **評価指標 TS-010-07**: Collector latency < 100ms
- **監視ポイント TS-010-08**: health_check受信
- **撤退トリガー TS-010-09**: 重大CVE放置
- **フォールバック TS-010-10**: Vector (Rust)
- **フォローアップ TS-010-11**: `telemetry/collector.md`

#### レコード TS-011: ClickHouse Cloud (Serverless)
- **カテゴリ TS-011-01**: 分析DB
- **コンポーネント TS-011-02**: ClickHouse Cloud (Go管理)
- **バージョンポリシー TS-011-03**: SaaS自動
- **適用範囲 TS-011-04**: 高粒度テレメトリ
- **主要メリット TS-011-05**: 高速分析
- **主要リスク TS-011-06**: C++ベースだがマネージドのため利用可否要審査
- **評価指標 TS-011-07**: クエリP95<400ms
- **監視ポイント TS-011-08**: SaaSステータス
- **撤退トリガー TS-011-09**: C++依存がAPIレベルに露出
- **フォールバック TS-011-10**: CockroachDB + Materialized Views
- **フォローアップ TS-011-11**: `risk-register.md`

#### レコード TS-012: Loki Alternative (Go)
- **カテゴリ TS-012-01**: ログストレージ
- **コンポーネント TS-012-02**: Grafana Loki (Go)
- **バージョンポリシー TS-012-03**: minor毎にcompatテスト
- **適用範囲 TS-012-04**: ログ集約
- **主要メリット TS-012-05**: ラベルクエリ、軽量
- **主要リスク TS-012-06**: インデックス膨張
- **評価指標 TS-012-07**: インデックスサイズ/日<50GB
- **監視ポイント TS-012-08**: compactorログ
- **撤退トリガー TS-012-09**: SLO違反が30日継続
- **フォールバック TS-012-10**: Elastic Cloud (Java)
- **フォローアップ TS-012-11**: `telemetry/logging.md`

#### レコード TS-013: Tempo (分散トレース)
- **カテゴリ TS-013-01**: トレーシング
- **コンポーネント TS-013-02**: Grafana Tempo (Go)
- **バージョンポリシー TS-013-03**: quarterly更新
- **適用範囲 TS-013-04**: 分散トレース保存
- **主要メリット TS-013-05**: high retention
- **主要リスク TS-013-06**: オブジェクトストア依存
- **評価指標 TS-013-07**: ingest latency<200ms
- **監視ポイント TS-013-08**: Tempo metrics
- **撤退トリガー TS-013-09**: backend S3 SLA違反
- **フォールバック TS-013-10**: Jaeger (Go)
- **フォローアップ TS-013-11**: `telemetry/tracing.md`

#### レコード TS-014: Prometheus (Go)
- **カテゴリ TS-014-01**: メトリクス
- **コンポーネント TS-014-02**: Prometheus 2.x (Go)
- **バージョンポリシー TS-014-03**: LTS追従
- **適用範囲 TS-014-04**: コアメトリクス収集
- **主要メリット TS-014-05**: pull型, Alertmanager連携
- **主要リスク TS-014-06**: TSDB肥大
- **評価指標 TS-014-07**: cardinality<5M
- **監視ポイント TS-014-08**: compactionエラー
- **撤退トリガー TS-014-09**: ストレージ圧力が運用限界
- **フォールバック TS-014-10**: VictoriaMetrics (Go)
- **フォローアップ TS-014-11**: `telemetry/metrics.md`

#### レコード TS-015: Grafana (Go)
- **カテゴリ TS-015-01**: 可視化
- **コンポーネント TS-015-02**: Grafana OSS 10
- **バージョンポリシー TS-015-03**: minor適用を2ヶ月毎
- **適用範囲 TS-015-04**: ダッシュボード
- **主要メリット TS-015-05**: datasource統合
- **主要リスク TS-015-06**: プラグインの脆弱性
- **評価指標 TS-015-07**: プラグイン監査0件失敗
- **監視ポイント TS-015-08**: plugin security advisories
- **撤退トリガー TS-015-09**: 必須機能が商用限定へ移行
- **フォールバック TS-015-10**: Superset (Python)
- **フォローアップ TS-015-11**: `telemetry/dashboards.md`

#### レコード TS-016: S3互換オブジェクトストア (Go SDK)
- **カテゴリ TS-016-01**: ストレージ
- **コンポーネント TS-016-02**: MinIO (Go)
- **バージョンポリシー TS-016-03**: 月次更新, Helm管理
- **適用範囲 TS-016-04**: 監査WORM, テレメトリバルク
- **主要メリット TS-016-05**: S3互換, Go実装
- **主要リスク TS-016-06**: ストレージ冗長性
- **評価指標 TS-016-07**: Erasure Coding耐久度
- **監視ポイント TS-016-08**: heal-status
- **撤退トリガー TS-016-09**: 連続故障でデータ損失懸念
- **フォールバック TS-016-10**: クラウドS3
- **フォローアップ TS-016-11**: `deployment/storage.md`

#### レコード TS-017: Keycloak (Java)
- **カテゴリ TS-017-01**: IDプロバイダ
- **コンポーネント TS-017-02**: Keycloak 23 (Quarkus)
- **バージョンポリシー TS-017-03**: LTS選択, 年2回更新
- **適用範囲 TS-017-04**: OIDC, RBAC
- **主要メリット TS-017-05**: ポリシー表現力
- **主要リスク TS-017-06**: JVM運用
- **評価指標 TS-017-07**: ログイン成功率>99.9%
- **監視ポイント TS-017-08**: adminイベント
- **撤退トリガー TS-017-09**: JDK依存でCライブラリ必須となる
- **フォールバック TS-017-10**: Auth0 (SaaS)
- **フォローアップ TS-017-11**: `security/auth.md`

#### レコード TS-018: Open Policy Agent (Go)
- **カテゴリ TS-018-01**: ポリシー評価
- **コンポーネント TS-018-02**: OPA 0.57 (Go)
- **バージョンポリシー TS-018-03**: minorごとにRegoテスト
- **適用範囲 TS-018-04**: Capability判定, API認可
- **主要メリット TS-018-05**: Regoで高表現力
- **主要リスク TS-018-06**: レイテンシ増
- **評価指標 TS-018-07**: Eval latency < 10ms
- **監視ポイント TS-018-08**: decision logs
- **撤退トリガー TS-018-09**: レイテンシが閾値超過
- **フォールバック TS-018-10**: 内製Rust判定器
- **フォローアップ TS-018-11**: `security/policy.md`

#### レコード TS-019: Envoy ランタイム回避策
- **カテゴリ TS-019-01**: プロキシ
- **コンポーネント TS-019-02**: Envoy (C++)は直接採用せず、Rust/Goラッパで抽象
- **バージョンポリシー TS-019-03**: SaaS/API経由で利用
- **適用範囲 TS-019-04**: TLS終端
- **主要メリット TS-019-05**: 実績
- **主要リスク TS-019-06**: C++依存の露出
- **評価指標 TS-019-07**: 直接バイナリをリンクしない
- **監視ポイント TS-019-08**: SaaSリリースノート
- **撤退トリガー TS-019-09**: C++コードを自社でビルドする必要が出た場合
- **フォールバック TS-019-10**: Rustベースproxygen (例: `sozu`検討)
- **フォローアップ TS-019-11**: `risk-register.md`

#### レコード TS-020: Traefik (Go)
- **カテゴリ TS-020-01**: エッジプロキシ
- **コンポーネント TS-020-02**: Traefik v3
- **バージョンポリシー TS-020-03**: minor更新を半期
- **適用範囲 TS-020-04**: Public Ingress
- **主要メリット TS-020-05**: Go実装, CRD管理
- **主要リスク TS-020-06**: CRD肥大
- **評価指標 TS-020-07**: 再読み込み遅延<5s
- **監視ポイント TS-020-08**: Traefikダッシュボード
- **撤退トリガー TS-020-09**: CRD互換崩壊
- **フォールバック TS-020-10**: Istio Ingress (Goコントロール)
- **フォローアップ TS-020-11**: `deployment/networking.md`

#### レコード TS-021: Kubernetes (Managed)
- **カテゴリ TS-021-01**: オーケストレーション
- **コンポーネント TS-021-02**: AKS/ EKS (管理プレーンGo)
- **バージョンポリシー TS-021-03**: N-1サポート, 年2回アップグレード
- **適用範囲 TS-021-04**: すべてのサービス
- **主要メリット TS-021-05**: スケーリング, RBAC
- **主要リスク TS-021-06**: アップグレード複雑
- **評価指標 TS-021-07**: Control plane availability 99.95%
- **監視ポイント TS-021-08**: Cloud status page
- **撤退トリガー TS-021-09**: マネージドからセルフ運用への強制
- **フォールバック TS-021-10**: Nomad + Consul (Go)
- **フォローアップ TS-021-11**: `deployment/kubernetes.md`

#### レコード TS-022: Helm (Go)
- **カテゴリ TS-022-01**: デプロイメント
- **コンポーネント TS-022-02**: Helm 3.14
- **バージョンポリシー TS-022-03**: 最新安定版追従
- **適用範囲 TS-022-04**: すべてのチャート管理
- **主要メリット TS-022-05**: テンプレート再利用
- **主要リスク TS-022-06**: テンプレート複雑化
- **評価指標 TS-022-07**: lint警告ゼロ
- **監視ポイント TS-022-08**: Chart Museum
- **撤退トリガー TS-022-09**: Cバイナリ依存が出現
- **フォールバック TS-022-10**: Kustomize (Go)
- **フォローアップ TS-022-11**: `deployment/charts.md`

#### レコード TS-023: Argo CD (Go)
- **カテゴリ TS-023-01**: GitOps
- **コンポーネント TS-023-02**: Argo CD 2.9
- **バージョンポリシー TS-023-03**: minorごとにブルーグリーン導入
- **適用範囲 TS-023-04**: Kubernetesデプロイ同期
- **主要メリット TS-023-05**: 宣言的同期
- **主要リスク TS-023-06**: RBAC設定複雑
- **評価指標 TS-023-07**: syncエラー率<1%
- **監視ポイント TS-023-08**: Application CR status
- **撤退トリガー TS-023-09**: セキュリティCVE放置
- **フォールバック TS-023-10**: FluxCD (Go)
- **フォローアップ TS-023-11**: `deployment/gitops.md`

#### レコード TS-024: Terraform (Go)
- **カテゴリ TS-024-01**: IaC
- **コンポーネント TS-024-02**: Terraform 1.7 (CLI)
- **バージョンポリシー TS-024-03**: minor固定, provider更新月次
- **適用範囲 TS-024-04**: クラウドリソース
- **主要メリット TS-024-05**: プラグイン豊富
- **主要リスク TS-024-06**: 状態管理
- **評価指標 TS-024-07**: `terraform validate`無警告
- **監視ポイント TS-024-08**: S3 backend
- **撤退トリガー TS-024-09**: ライセンス変更で商用制限
- **フォールバック TS-024-10**: Pulumi (Go SDK)
- **フォローアップ TS-024-11**: `deployment/iac.md`

#### レコード TS-025: Tilt (Go)
- **カテゴリ TS-025-01**: ローカル開発
- **コンポーネント TS-025-02**: Tilt 0.33
- **バージョンポリシー TS-025-03**: 月次更新
- **適用範囲 TS-025-04**: 開発者向けK8sライブリロード
- **主要メリット TS-025-05**: 開発体験向上
- **主要リスク TS-025-06**: 学習曲線
- **評価指標 TS-025-07**: 起動時間<60s
- **監視ポイント TS-025-08**: Tilt analytics
- **撤退トリガー TS-025-09**: 互換破壊が頻発
- **フォールバック TS-025-10**: Skaffold (Go)
- **フォローアップ TS-025-11**: `development/workflow.md`

#### レコード TS-026: Wasmtime (Rust)
- **カテゴリ TS-026-01**: サンドボックス
- **コンポーネント TS-026-02**: Wasmtime 14 (Rust)
- **バージョンポリシー TS-026-03**: minor更新を半期
- **適用範囲 TS-026-04**: プラグイン実行環境
- **主要メリット TS-026-05**: 安全なWasm VM
- **主要リスク TS-026-06**: Cold start
- **評価指標 TS-026-07**: 起動<30ms
- **監視ポイント TS-026-08**: セキュリティ勧告
- **撤退トリガー TS-026-09**: CVE対応遅延
- **フォールバック TS-026-10**: Wasmer (Rust)
- **フォローアップ TS-026-11**: `architecture/overview.md`補足

#### レコード TS-027: Tokio (Rust)
- **カテゴリ TS-027-01**: 非同期ランタイム
- **コンポーネント TS-027-02**: Tokio 1.x
- **バージョンポリシー TS-027-03**: LTS追従
- **適用範囲 TS-027-04**: Core/Stream
- **主要メリット TS-027-05**: 高性能async
- **主要リスク TS-027-06**: Runtime設定誤り
- **評価指標 TS-027-07**: task starvationゼロ
- **監視ポイント TS-027-08**: Tokio Console
- **撤退トリガー TS-027-09**: 重大CVE未修正
- **フォールバック TS-027-10**: async-std (Rust)
- **フォローアップ TS-027-11**: `performance/runtime.md`

#### レコード TS-028: Actix Web除外ポリシー
- **カテゴリ TS-028-01**: Webフレームワークゴバナンス
- **コンポーネント TS-028-02**: ActixはC依存無しだがunsafe多用のため採用外
- **バージョンポリシー TS-028-03**: 評価結果維持
- **適用範囲 TS-028-04**: HTTPエンドポイント
- **主要メリット TS-028-05**: N/A
- **主要リスク TS-028-06**: unsafe
- **評価指標 TS-028-07**: 禁止リスト遵守
- **監視ポイント TS-028-08**: 依存チェックCI
- **撤退トリガー TS-028-09**: ルール違反コミット検出
- **フォールバック TS-028-10**: Axum (Rust)
- **フォローアップ TS-028-11**: `security/supply-chain.md`

#### レコード TS-029: Axum (Rust)
- **カテゴリ TS-029-01**: HTTPサーバ
- **コンポーネント TS-029-02**: Axum 0.7 (Rust)
- **バージョンポリシー TS-029-03**: quarterly更新
- **適用範囲 TS-029-04**: 外部API
- **主要メリット TS-029-05**: Tower互換, 安全
- **主要リスク TS-029-06**: ラーニングカーブ
- **評価指標 TS-029-07**: p95 latency<120ms
- **監視ポイント TS-029-08**: Tower metrics
- **撤退トリガー TS-029-09**: 重大バグ
- **フォールバック TS-029-10**: Hyper + our DSL
- **フォローアップ TS-029-11**: `architecture/interfaces.md`

#### レコード TS-030: Tonic (Rust)
- **カテゴリ TS-030-01**: gRPC
- **コンポーネント TS-030-02**: tonic 0.10
- **バージョンポリシー TS-030-03**: 月次dependabot
- **適用範囲 TS-030-04**: 内部RPC
- **主要メリット TS-030-05**: Rust native
- **主要リスク TS-030-06**: build.rs生成
- **評価指標 TS-030-07**: 生成コードサイズ<20MB
- **監視ポイント TS-030-08**: build-protoc pipeline
- **撤退トリガー TS-030-09**: Cツールチェーン必須化
- **フォールバック TS-030-10**: gRPC-Web + Axum
- **フォローアップ TS-030-11**: `build-protoc/Cargo.toml`

#### レコード TS-031: Prost (Rust)
- **カテゴリ TS-031-01**: プロトコル生成
- **コンポーネント TS-031-02**: prost 0.12
- **バージョンポリシー TS-031-03**: dependabot三半期
- **適用範囲 TS-031-04**: Protobufコード生成
- **主要メリット TS-031-05**: 純Rust
- **主要リスク TS-031-06**: 大規模protoのコンパイル時間
- **評価指標 TS-031-07**: コード生成時間<5分
- **監視ポイント TS-031-08**: build logs
- **撤退トリガー TS-031-09**: 生成中にCツール必須化
- **フォールバック TS-031-10**: quick-protobuf
- **フォローアップ TS-031-11**: `build-protoc/README.md`

#### レコード TS-032: Serde (Rust)
- **カテゴリ TS-032-01**: シリアライゼーション
- **コンポーネント TS-032-02**: Serde 1.0
- **バージョンポリシー TS-032-03**: patch追従
- **適用範囲 TS-032-04**: JSON/YAML
- **主要メリット TS-032-05**: 高速, 広範囲
- **主要リスク TS-032-06**: deriveマクロ複雑
- **評価指標 TS-032-07**: デシリアライズ失敗率<0.1%
- **監視ポイント TS-032-08**: telemetry error rate
- **撤退トリガー TS-032-09**: deriveによる安全性問題
- **フォールバック TS-032-10**: miniserde
- **フォローアップ TS-032-11**: `architecture/dataflow.md`

#### レコード TS-033: Reqwest (Rust)
- **カテゴリ TS-033-01**: HTTPクライアント
- **コンポーネント TS-033-02**: reqwest 0.11 (Rust)
- **バージョンポリシー TS-033-03**: dependabot月次
- **適用範囲 TS-033-04**: Telemetry Export, Governance連携
- **主要メリット TS-033-05**: TLSサポート (rustls)
- **主要リスク TS-033-06**: blocking機能誤用
- **評価指標 TS-033-07**: TLS handshake p95<80ms
- **監視ポイント TS-033-08**: rustlsバージョン
- **撤退トリガー TS-033-09**: native-tls依存が必要になった場合
- **フォールバック TS-033-10**: hyper client + rustls
- **フォローアップ TS-033-11**: `security/tls.md`

#### レコード TS-034: Rustls
- **カテゴリ TS-034-01**: TLS
- **コンポーネント TS-034-02**: rustls 0.22
- **バージョンポリシー TS-034-03**: セキュリティリリース即時適用
- **適用範囲 TS-034-04**: すべてのTLS終端/発信
- **主要メリット TS-034-05**: 純Rust, FIPS準備
- **主要リスク TS-034-06**: FIPS認証未取得
- **評価指標 TS-034-07**: ハンドシェイク成功率>99.99%
- **監視ポイント TS-034-08**: TLSエラー指標
- **撤退トリガー TS-034-09**: FIPS要件が外部から課される
- **フォールバック TS-034-10**: AWS ACM統合
- **フォローアップ TS-034-11**: `security/compliance.md`

#### レコード TS-035: Ring排除方針
- **カテゴリ TS-035-01**: 暗号ライブラリ
- **コンポーネント TS-035-02**: ring (C依存)は採用しない
- **バージョンポリシー TS-035-03**: 禁止リスト保持
- **適用範囲 TS-035-04**: 暗号
- **主要メリット TS-035-05**: N/A
- **主要リスク TS-035-06**: C依存混入
- **評価指標 TS-035-07**: Cargo deny
- **監視ポイント TS-035-08**: 依存グラフ
- **撤退トリガー TS-035-09**: 違反検知
- **フォールバック TS-035-10**: RustCrypto
- **フォローアップ TS-035-11**: `security/supply-chain.md`

#### レコード TS-036: pqcrypto (Rust)
- **カテゴリ TS-036-01**: PQ暗号
- **コンポーネント TS-036-02**: pqcrypto 0.9
- **バージョンポリシー TS-036-03**: draft更新レビュー
- **適用範囲 TS-036-04**: Handshake PQ機能
- **主要メリット TS-036-05**: PQ対応
- **主要リスク TS-036-06**: 標準化動向
- **評価指標 TS-036-07**: ベンチマーク性能>80%目標
- **監視ポイント TS-036-08**: NIST PQC発表
- **撤退トリガー TS-036-09**: 標準乖離が顕著
- **フォールバック TS-036-10**: Kyber (Pure Go)
- **フォローアップ TS-036-11**: `nyx-crypto/HYBRID_HANDSHAKE.md`

#### レコード TS-037: BLAKE3 (Rust)
- **カテゴリ TS-037-01**: ハッシュ
- **コンポーネント TS-037-02**: blake3 1.5 (Rust)
- **バージョンポリシー TS-037-03**: patch追従
- **適用範囲 TS-037-04**: ハッシュ, PRNG
- **主要メリット TS-037-05**: SIMD最適化
- **主要リスク TS-037-06**: SIMDサポート差
- **評価指標 TS-037-07**: throughput>1GB/s
- **監視ポイント TS-037-08**: CPUフラグ
- **撤退トリガー TS-037-09**: SIMD非対応環境が半数超
- **フォールバック TS-037-10**: SHA3 (Rust)
- **フォローアップ TS-037-11**: `performance/crypto.md`

#### レコード TS-038: Reed-Solomon erasure (Rust)
- **カテゴリ TS-038-01**: FEC
- **コンポーネント TS-038-02**: reed-solomon-erasure 6.x
- **バージョンポリシー TS-038-03**: patch追従
- **適用範囲 TS-038-04**: FECモジュール
- **主要メリット TS-038-05**: 純Rust
- **主要リスク TS-038-06**: FEC計算コスト
- **評価指標 TS-038-07**: エンコードレイテンシ<5ms
- **監視ポイント TS-038-08**: CPU使用率
- **撤退トリガー TS-038-09**: レイテンシSLO超
- **フォールバック TS-038-10**: LDPC Rust実装
- **フォローアップ TS-038-11**: `nyx-fec/README.md`

#### レコード TS-039: Tokio Metrics
- **カテゴリ TS-039-01**: メトリクス収集
- **コンポーネント TS-039-02**: tokio-metrics crate
- **バージョンポリシー TS-039-03**: minor追従
- **適用範囲 TS-039-04**: ランタイム可視化
- **主要メリット TS-039-05**: タスク可視化
- **主要リスク TS-039-06**: オーバーヘッド
- **評価指標 TS-039-07**: overhead<5%
- **監視ポイント TS-039-08**: exporter latency
- **撤退トリガー TS-039-09**: オーバーヘッド>10%
- **フォールバック TS-039-10**: custom metrics
- **フォローアップ TS-039-11**: `telemetry/runtime.md`

#### レコード TS-040: Tracing crate
- **カテゴリ TS-040-01**: ロギング
- **コンポーネント TS-040-02**: tracing 0.1 + tracing-subscriber
- **バージョンポリシー TS-040-03**: 月次更新
- **適用範囲 TS-040-04**: コアロギング
- **主要メリット TS-040-05**: 構造化ログ
- **主要リスク TS-040-06**: Subscriber設定複雑
- **評価指標 TS-040-07**: ログドロップ率<0.5%
- **監視ポイント TS-040-08**: backpressure
- **撤退トリガー TS-040-09**: SubscriberがC依存導入
- **フォールバック TS-040-10**: log crate + slog
- **フォローアップ TS-040-11**: `telemetry/logging.md`

#### レコード TS-041: Cargo deny (Rust)
- **カテゴリ TS-041-01**: サプライチェーンガード
- **コンポーネント TS-041-02**: cargo-deny
- **バージョンポリシー TS-041-03**: 月次更新
- **適用範囲 TS-041-04**: 依存チェック
- **主要メリット TS-041-05**: C依存検出
- **主要リスク TS-041-06**: 設定誤検知
- **評価指標 TS-041-07**: CI失敗ゼロ
- **監視ポイント TS-041-08**: deny.toml
- **撤退トリガー TS-041-09**: メンテ停止
- **フォールバック TS-041-10**: cargo-audit + custom scripts
- **フォローアップ TS-041-11**: `security/supply-chain.md`

#### レコード TS-042: Cargo audit
- **カテゴリ TS-042-01**: セキュリティ監査
- **コンポーネント TS-042-02**: cargo-audit
- **バージョンポリシー TS-042-03**: 月次
- **適用範囲 TS-042-04**: CVE検出
- **主要メリット TS-042-05**: Advisory DB
- **主要リスク TS-042-06**: False positive
- **評価指標 TS-042-07**: 未解決CVE=0
- **監視ポイント TS-042-08**: Advisory Feed
- **撤退トリガー TS-042-09**: DB停滞
- **フォールバック TS-042-10**: OSV-Scanner
- **フォローアップ TS-042-11**: `security/vulnerability-management.md`

#### レコード TS-043: Dependabot
- **カテゴリ TS-043-01**: 依存管理
- **コンポーネント TS-043-02**: GitHub Dependabot
- **バージョンポリシー TS-043-03**: 週次スキャン
- **適用範囲 TS-043-04**: 全リポジトリ
- **主要メリット TS-043-05**: 自動PR
- **主要リスク TS-043-06**: PRスパム
- **評価指標 TS-043-07**: 平均マージ期間<14日
- **監視ポイント TS-043-08**: SECURITY.md
- **撤退トリガー TS-043-09**: 重大な誤検知
- **フォールバック TS-043-10**: Renovate (Go)
- **フォローアップ TS-043-11**: `governance/process.md`

#### レコード TS-044: MkDocs (Python)
- **カテゴリ TS-044-01**: ドキュメント基盤
- **コンポーネント TS-044-02**: MkDocs Material
- **バージョンポリシー TS-044-03**: 四半期更新
- **適用範囲 TS-044-04**: Docsサイト
- **主要メリット TS-044-05**: マークダウン拡張
- **主要リスク TS-044-06**: プラグインC依存混入
- **評価指標 TS-044-07**: build時間<5分
- **監視ポイント TS-044-08**: requirementsロック
- **撤退トリガー TS-044-09**: C拡張必須プラグイン登場
- **フォールバック TS-044-10**: Docusaurus (Node)
- **フォローアップ TS-044-11**: `docs/README.md`

#### レコード TS-045: Pandoc排除方針
- **カテゴリ TS-045-01**: ドキュメントツール
- **コンポーネント TS-045-02**: Pandoc (Haskell/C依存)はCIで使用しない
- **バージョンポリシー TS-045-03**: 禁止
- **適用範囲 TS-045-04**: Docs生成
- **主要メリット TS-045-05**: N/A
- **主要リスク TS-045-06**: C依存
- **評価指標 TS-045-07**: CIにPandocが存在しない
- **監視ポイント TS-045-08**: CIビルド
- **撤退トリガー TS-045-09**: 依存混入検知
- **フォールバック TS-045-10**: MkDocs, Python scripts
- **フォローアップ TS-045-11**: `governance/process.md`

#### レコード TS-046: PyO3排除ポリシー
- **カテゴリ TS-046-01**: バインディング
- **コンポーネント TS-046-02**: PyO3 (Rust↔Python, C依存)は採用禁止
- **バージョンポリシー TS-046-03**: 禁止
- **適用範囲 TS-046-04**: FFI
- **主要メリット TS-046-05**: なし
- **主要リスク TS-046-06**: CAPI依存
- **評価指標 TS-046-07**: Cargo deny violation=0
- **監視ポイント TS-046-08**: 依存グラフ
- **撤退トリガー TS-046-09**: 違反コミット
- **フォールバック TS-046-10**: REST/gRPC
- **フォローアップ TS-046-11**: `architecture/interfaces.md`

y+- **カテゴリ TS-047-01**: サンドボックス候補
- **コンポーネント TS-047-02**: WasmEdge (C++ベース) → 評価中止
#### レコード TS-047: WasmEdge評価
- **カテゴリ TS-047-01**: サンドボックス候補
- **コンポーネント TS-047-02**: WasmEdge (C++ベース) → 評価中止
- **コンポーネント TS-047-02**: WasmEdge (C++ベース) → 評価中止
- **バージョンポリシー TS-047-03**: 禁止
- **適用範囲 TS-047-04**: N/A
- **主要メリット TS-047-05**: 高性能 (参考)
- **主要リスク TS-047-06**: C++/LLVM依存
- **評価指標 TS-047-07**: 禁止リスト維持
- **監視ポイント TS-047-08**: 調査ログ
- **撤退トリガー TS-047-09**: 評価再開指示
- **フォールバック TS-047-10**: Wasmtime
- **フォローアップ TS-047-11**: `notes/decision-log.md`

#### レコード TS-048: Nyx CLI (Rust)
- **カテゴリ TS-048-01**: CLI
- **コンポーネント TS-048-02**: nyx-cli crate (Rust)
- **バージョンポリシー TS-048-03**: SemVer, release-please
- **適用範囲 TS-048-04**: 運用コマンド
- **主要メリット TS-048-05**: 実装と同言語
- **主要リスク TS-048-06**: バイナリサイズ
- **評価指標 TS-048-07**: size<50MB
- **監視ポイント TS-048-08**: CLI Telemetry
- **撤退トリガー TS-048-09**: 依存にC混入
- **フォールバック TS-048-10**: Go CLI
- **フォローアップ TS-048-11**: `nyx-cli/README.md`

#### レコード TS-049: Nyx SDK (Rust)
- **カテゴリ TS-049-01**: SDK
- **コンポーネント TS-049-02**: nyx-sdk (Rust)
- **バージョンポリシー TS-049-03**: SemVer, LTS=2 minor
- **適用範囲 TS-049-04**: クライアント統合
- **主要メリット TS-049-05**: API契約準拠
- **主要リスク TS-049-06**: バイナリ互換
- **評価指標 TS-049-07**: API Breaking=0/quarter
- **監視ポイント TS-049-08**: SemVer bot
- **撤退トリガー TS-049-09**: C依存導入
- **フォールバック TS-049-10**: Go SDK
- **フォローアップ TS-049-11**: `architecture/interfaces.md`

#### レコード TS-050: Nyx SDK WASM版
- **カテゴリ TS-050-01**: SDK拡張
- **コンポーネント TS-050-02**: nyx-sdk-wasm (Rust→WASM)
- **バージョンポリシー TS-050-03**: wasm-bindgen安定版追従、C依存無いこと
- **適用範囲 TS-050-04**: ブラウザ連携
- **主要メリット TS-050-05**: Web配布, 安全性
- **主要リスク TS-050-06**: wasm-bindgenの互換性
- **評価指標 TS-050-07**: bundle<1MB
- **監視ポイント TS-050-08**: wasm-bindgenセキュリティ
- **撤退トリガー TS-050-09**: JS側polyfill要求がC依存
- **フォールバック TS-050-10**: WebSocket API + Go SDK
- **フォローアップ TS-050-11**: `nyx-sdk-wasm/README.md`

> **宣言**: 本書で提示する技術選定は、実装コードを含まず、C/C++依存ライブラリを採用しない。